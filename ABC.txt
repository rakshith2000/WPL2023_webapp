def get_service_stat(service):
                regex_pattern = service.replace('*', '.*').replace('?', '.')
                regex_pattern = f"^{regex_pattern}$"  # Anchors the pattern to match the full service name

                # Query for all services
                matched_services = []
                for service in conn.Win32_Service():
                    # Match service name using the regex pattern (case-insensitive)
                    if re.match(regex_pattern, service.Name, re.IGNORECASE):
                        service_status = {
                            'Service Name': service.Name,
                            'Display Name': service.DisplayName,
                            'State': service.State,
                        }
                        matched_services.append(service_status)
                
                if matched_services:
                    return matched_services[0]['State'] + " (" + matched_services[0]['Display Name'].split('(')[1] 
                else:
                    return "NA"
                    
            metrics['moca_serv'] = get_service_stat('moca*')
            metrics['refs_serv'] = get_service_stat('REFS*')
            metrics['blueyonder_serv'] = get_service_stat('RedPrairie*')
