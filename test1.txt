import wmi

def get_cpu_info_fast(server, username, password):
    try:
        # Connect with explicit timeout settings
        connection = wmi.WMI(
            computer=server,
            user=username,
            password=password,
            timeout=3  # Set connection timeout
        )
        
        # Query only specific properties you need
        cpu_info = connection.Win32_Processor(
            fields=["Name", "NumberOfCores", "NumberOfLogicalProcessors", "MaxClockSpeed", "LoadPercentage"]
        )
        
        return [{
            'Name': cpu.Name,
            'Cores': cpu.NumberOfCores,
            'Threads': cpu.NumberOfLogicalProcessors,
            'MaxSpeed': cpu.MaxClockSpeed,
            'Load': cpu.LoadPercentage
        } for cpu in cpu_info]
    
    except Exception as e:
        return {"error": str(e)}
