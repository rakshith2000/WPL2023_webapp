import subprocess

def get_cpu_ps_remote(server):
    ps_script = """
    Get-CimInstance Win32_Processor | 
    Select-Object Name, NumberOfCores, NumberOfLogicalProcessors, MaxClockSpeed |
    ConvertTo-Json
    """
    cmd = [
        "powershell",
        "-Command",
        f"Invoke-Command -ComputerName {server} -ScriptBlock {{{ps_script}}}"
    ]
    result = subprocess.run(cmd, capture_output=True, text=True)
    return result.stdout
