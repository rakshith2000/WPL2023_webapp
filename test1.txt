import wmi

def get_service_status(service_name):
    # Initialize the WMI client
    c = wmi.WMI()

    # Query WMI for the status of the service
    for service in c.Win32_Service(Name=service_name):
        service_status = {
            'Service Name': service.Name,
            'Display Name': service.DisplayName,
            'State': service.State,          # Running, Stopped, etc.
            'Status': service.Status,        # Started, Stopped, etc.
            'Start Mode': service.StartMode, # Manual, Auto, Disabled
            'Process ID': service.ProcessId
        }
        return service_status
    return f"Service '{service_name}' not found."

# Example Usage:
service_name = "wuauserv"  # Windows Update Service
service_info = get_service_status(service_name)

# Print service status
if isinstance(service_info, dict):
    print(f"Service: {service_info['Display Name']}")
    print(f"State: {service_info['State']}")
    print(f"Status: {service_info['Status']}")
    print(f"Start Mode: {service_info['Start Mode']}")
    print(f"Process ID: {service_info['Process ID']}")
else:
    print(service_info)
